<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PULSE | Global Intelligence Platform</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'void': '#000000',
                        'abyss': '#03030a',
                        'obsidian': '#080812',
                        'onyx': '#0c0c18',
                        'slate': '#12121f',
                        'graphite': '#1a1a2e',
                        'steel': '#252540',
                        'silver': '#7a7a9a',
                        'ghost': '#a0a0c0',
                        'white': '#e8e8f0',
                        'accent': '#00e5ff',
                        'accent2': '#7b61ff',
                        'success': '#00ff9d',
                        'warning': '#ffc107',
                        'danger': '#ff4757',
                        'critical': '#ff0040',
                        'info': '#3d8bff',
                        'muted': '#4a4a6a',
                    },
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif'],
                        'mono': ['JetBrains Mono', 'monospace'],
                    },
                }
            }
        }
    </script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body, #root { height: 100%; width: 100%; overflow: hidden; }
        
        ::-webkit-scrollbar { width: 5px; height: 5px; }
        ::-webkit-scrollbar-track { background: rgba(0,0,0,0.2); }
        ::-webkit-scrollbar-thumb { background: #252540; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #3d3d5c; }
        
        /* Glass morphism - enhanced */
        .glass { 
            background: linear-gradient(135deg, rgba(12, 12, 24, 0.95) 0%, rgba(8, 8, 18, 0.98) 100%);
            backdrop-filter: blur(20px); 
            border: 1px solid rgba(255, 255, 255, 0.06);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255,255,255,0.05);
        }
        .glass-light { 
            background: linear-gradient(135deg, rgba(18, 18, 31, 0.9) 0%, rgba(12, 12, 24, 0.95) 100%);
            backdrop-filter: blur(12px); 
            border: 1px solid rgba(255, 255, 255, 0.04);
        }
        .glass-dark {
            background: rgba(3, 3, 10, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.03);
        }
        
        /* Map styling */
        .leaflet-container { background: #03030a !important; }
        .leaflet-control-zoom, .leaflet-control-attribution { display: none !important; }
        .leaflet-popup-content-wrapper { 
            background: linear-gradient(135deg, rgba(12, 12, 24, 0.98) 0%, rgba(8, 8, 18, 0.99) 100%) !important;
            border: 1px solid rgba(0, 229, 255, 0.4) !important; 
            border-radius: 12px !important; 
            color: #e8e8f0 !important; 
            box-shadow: 0 0 60px rgba(0, 229, 255, 0.2), 0 25px 50px rgba(0,0,0,0.5) !important; 
        }
        .leaflet-popup-tip { background: rgba(12, 12, 24, 0.98) !important; border: 1px solid rgba(0, 229, 255, 0.4) !important; }
        .leaflet-popup-content { margin: 0 !important; }
        
        /* Animations */
        @keyframes pulse-ring { 0% { transform: scale(1); opacity: 0.6; } 100% { transform: scale(3); opacity: 0; } }
        @keyframes glow { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        @keyframes ticker { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
        @keyframes load { 0% { width: 0; } 100% { width: 100%; } }
        @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
        @keyframes scanline { 0% { top: -5%; } 100% { top: 105%; } }
        @keyframes dataStream { 0% { opacity: 0; transform: translateY(-10px); } 50% { opacity: 1; } 100% { opacity: 0; transform: translateY(10px); } }
        @keyframes borderGlow { 0%, 100% { border-color: rgba(0, 229, 255, 0.3); } 50% { border-color: rgba(0, 229, 255, 0.6); } }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
        
        .animate-pulse-ring { animation: pulse-ring 2.5s ease-out infinite; }
        .animate-glow { animation: glow 2s ease-in-out infinite; }
        .animate-border-glow { animation: borderGlow 3s ease-in-out infinite; }
        .animate-float { animation: float 6s ease-in-out infinite; }
        .skeleton { background: linear-gradient(90deg, #1a1a2e 25%, #252540 50%, #1a1a2e 75%); background-size: 200% 100%; animation: shimmer 1.5s infinite; }
        
        /* Scan line effect */
        .scanline::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, rgba(0, 229, 255, 0.4), transparent);
            animation: scanline 8s linear infinite;
            pointer-events: none;
            z-index: 100;
        }
        
        /* Grid patterns */
        .grid-pattern { 
            background-image: 
                linear-gradient(rgba(0, 229, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 229, 255, 0.03) 1px, transparent 1px);
            background-size: 40px 40px;
        }
        .grid-dots {
            background-image: radial-gradient(rgba(0, 229, 255, 0.15) 1px, transparent 1px);
            background-size: 20px 20px;
        }
        
        /* Gradients */
        .threat-gradient { background: linear-gradient(90deg, #00ff9d 0%, #7bff00 20%, #ffc107 40%, #ff8c00 60%, #ff4757 80%, #ff0040 100%); }
        .accent-gradient { background: linear-gradient(135deg, #00e5ff 0%, #7b61ff 100%); }
        .dark-gradient { background: linear-gradient(180deg, rgba(3,3,10,0) 0%, rgba(3,3,10,0.8) 100%); }
        
        /* Feed items */
        .feed-item { 
            transition: all 0.25s ease; 
            border-left: 2px solid transparent;
            position: relative;
        }
        .feed-item::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(90deg, rgba(0, 229, 255, 0.1) 0%, transparent 100%);
            opacity: 0;
            transition: opacity 0.25s ease;
        }
        .feed-item:hover::before { opacity: 1; }
        .feed-item:hover { border-left-color: #00e5ff; transform: translateX(2px); }
        .feed-item.critical { border-left-color: #ff0040; background: rgba(255, 0, 64, 0.05); }
        .feed-item.critical::before { background: linear-gradient(90deg, rgba(255, 0, 64, 0.1) 0%, transparent 100%); }
        .feed-item.elevated { border-left-color: #ffc107; background: rgba(255, 193, 7, 0.03); }
        
        /* Stats */
        .stat-number { font-variant-numeric: tabular-nums; letter-spacing: -0.03em; }
        
        /* Tweet cards */
        .tweet-card { 
            transition: all 0.25s ease;
            position: relative;
            overflow: hidden;
        }
        .tweet-card::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(0, 229, 255, 0.05) 0%, transparent 50%);
            opacity: 0;
            transition: opacity 0.25s ease;
        }
        .tweet-card:hover { 
            border-color: rgba(0, 229, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }
        .tweet-card:hover::after { opacity: 1; }
        
        /* HUD elements */
        .hud-corner {
            position: absolute;
            width: 20px;
            height: 20px;
            border-color: rgba(0, 229, 255, 0.5);
        }
        .hud-corner-tl { top: 0; left: 0; border-top: 2px solid; border-left: 2px solid; }
        .hud-corner-tr { top: 0; right: 0; border-top: 2px solid; border-right: 2px solid; }
        .hud-corner-bl { bottom: 0; left: 0; border-bottom: 2px solid; border-left: 2px solid; }
        .hud-corner-br { bottom: 0; right: 0; border-bottom: 2px solid; border-right: 2px solid; }
        
        /* Connection indicator */
        .connection-line {
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(0, 229, 255, 0.5), transparent);
        }
        
        /* Mini sparkline */
        .sparkline { display: flex; align-items: flex-end; gap: 1px; height: 20px; }
        .sparkline-bar { width: 3px; background: currentColor; border-radius: 1px; transition: height 0.3s ease; }
        
        /* Status indicators */
        .status-pulse {
            position: relative;
        }
        .status-pulse::after {
            content: '';
            position: absolute;
            inset: -4px;
            border-radius: 50%;
            background: currentColor;
            opacity: 0;
            animation: glow 2s ease-in-out infinite;
        }
        
        /* Data badge */
        .data-badge {
            font-size: 9px;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }
    </style>
</head>
<body class="bg-void text-white font-sans antialiased">
    <!-- Loading Screen - Enhanced -->
    <div id="loader" class="fixed inset-0 bg-void z-[100] flex items-center justify-center overflow-hidden">
        <div class="absolute inset-0 grid-dots opacity-30"></div>
        <div class="text-center relative z-10">
            <div class="relative mb-10">
                <div class="w-24 h-24 border-2 border-accent/20 rounded-full flex items-center justify-center">
                    <div class="w-16 h-16 border-2 border-accent/40 rounded-full flex items-center justify-center">
                        <div class="w-8 h-8 border-2 border-accent border-t-transparent rounded-full animate-spin"></div>
                    </div>
                </div>
                <div class="absolute inset-0 w-24 h-24 border border-accent/10 rounded-full animate-pulse-ring"></div>
                <div class="absolute inset-0 w-24 h-24 border border-accent/10 rounded-full animate-pulse-ring" style="animation-delay: 0.5s"></div>
            </div>
            <h1 class="text-3xl font-bold tracking-[0.3em] text-white mb-2">PULSE</h1>
            <p class="text-xs text-silver tracking-[0.2em] mb-8">GLOBAL INTELLIGENCE PLATFORM</p>
            <div class="w-64 h-1 bg-graphite rounded-full overflow-hidden mx-auto mb-3">
                <div class="h-full accent-gradient rounded-full" style="animation: load 2.2s ease-out forwards"></div>
            </div>
            <p class="text-xs text-muted font-mono" id="load-status">INITIALIZING CORE SYSTEMS...</p>
        </div>
    </div>
    
    <div id="root"></div>
    
    <script>
        var msgs = ['INITIALIZING CORE SYSTEMS...', 'ESTABLISHING SECURE CONNECTIONS...', 'LOADING THREAT INTELLIGENCE...', 'CALIBRATING SENSORS...', 'SYSTEM OPERATIONAL'];
        var i = 0;
        var int = setInterval(function() { if (++i < msgs.length) document.getElementById('load-status').textContent = msgs[i]; }, 450);
        setTimeout(function() { 
            clearInterval(int); 
            var l = document.getElementById('loader'); 
            l.style.opacity = '0'; 
            l.style.transition = 'opacity 0.4s ease-out'; 
            setTimeout(function() { l.style.display = 'none'; }, 400); 
        }, 2400);
    </script>
    
    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback, useMemo } = React;

        // ===================== CONFIGURATION =====================
        const CONFIG = {
            NEWS_INTERVAL: 90000,
            POLYMARKET_INTERVAL: 45000,
            MARKETS_INTERVAL: 20000,
            OSINT_INTERVAL: 30000,
            CLOCK_INTERVAL: 1000,
        };

        const DEFCON = {
            1: { n: 'COCKED PISTOL', d: 'Nuclear war imminent - Maximum readiness', c: '#ff0040', bg: 'rgba(255,0,64,0.15)' },
            2: { n: 'FAST PACE', d: 'Next step to nuclear war - Armed forces ready 6hrs', c: '#ff4757', bg: 'rgba(255,71,87,0.12)' },
            3: { n: 'ROUND HOUSE', d: 'Increased force readiness - Air Force ready 15min', c: '#ffc107', bg: 'rgba(255,193,7,0.12)' },
            4: { n: 'DOUBLE TAKE', d: 'Increased intelligence watch - Strengthened security', c: '#3d8bff', bg: 'rgba(61,139,255,0.12)' },
            5: { n: 'FADE OUT', d: 'Lowest state - Normal peacetime readiness', c: '#00ff9d', bg: 'rgba(0,255,157,0.12)' },
        };

        const ZONES = [
            { id: 1, name: 'KYIV', country: 'UKRAINE', coords: [50.45, 30.52], threat: 'critical', status: 'ACTIVE CONFLICT', activity: 94, intel: 'Russian strikes on energy infrastructure ongoing. Day 1,424 of conflict. Nationwide state of emergency.' },
            { id: 2, name: 'KHARKIV', country: 'UKRAINE', coords: [49.99, 36.23], threat: 'critical', status: 'FRONTLINE COMBAT', activity: 89, intel: 'Heavy bombardment continues. Mass civilian evacuation. Defense lines under pressure.' },
            { id: 3, name: 'TEHRAN', country: 'IRAN', coords: [35.69, 51.39], threat: 'critical', status: 'CIVIL UNREST', activity: 78, intel: 'Mass protests continuing. Internet restrictions active. International sanctions escalating.' },
            { id: 4, name: 'GAZA CITY', country: 'PALESTINE', coords: [31.52, 34.45], threat: 'critical', status: 'HUMANITARIAN CRISIS', activity: 96, intel: 'Active IDF operations. Severe aid restrictions. Casualty counts rising.' },
            { id: 5, name: 'BEIRUT', country: 'LEBANON', coords: [33.89, 35.50], threat: 'critical', status: 'HIGH ALERT', activity: 72, intel: 'Hezbollah-Israel tensions critical. Economic collapse continues.' },
            { id: 6, name: 'TAIPEI', country: 'TAIWAN', coords: [25.03, 121.57], threat: 'elevated', status: 'STRATEGIC WATCH', activity: 45, intel: 'PLA exercises in Taiwan Strait. INDOPACOM elevated. US carrier group deployed.' },
            { id: 7, name: 'PYONGYANG', country: 'DPRK', coords: [39.03, 125.75], threat: 'elevated', status: 'WEAPONS PROGRAM', activity: 58, intel: 'ICBM testing continues. Nuclear enrichment active. Satellite launches planned.' },
            { id: 8, name: 'CARACAS', country: 'VENEZUELA', coords: [10.48, -66.90], threat: 'elevated', status: 'INSTABILITY', activity: 41, intel: 'Political crisis deepening. SOUTHCOM monitoring. Regional migration crisis.' },
            { id: 9, name: 'MOSCOW', country: 'RUSSIA', coords: [55.76, 37.62], threat: 'watch', status: 'STRATEGIC COMMAND', activity: 67, intel: 'Coordinating Ukraine operations. Nuclear posture shifts. Western sanctions impact.' },
            { id: 10, name: 'BEIJING', country: 'CHINA', coords: [39.90, 116.41], threat: 'watch', status: 'STRATEGIC COMPETITION', activity: 52, intel: 'Taiwan pressure campaign. South China Sea activity. Tech decoupling accelerating.' },
            { id: 11, name: 'SEOUL', country: 'SOUTH KOREA', coords: [37.57, 126.98], threat: 'watch', status: 'DEFENSE POSTURE', activity: 35, intel: 'Joint exercises with US. THAAD operational. North Korea monitoring.' },
            { id: 12, name: 'DAMASCUS', country: 'SYRIA', coords: [33.51, 36.29], threat: 'elevated', status: 'CONFLICT ZONE', activity: 61, intel: 'Multi-party conflict ongoing. Russian/Iranian presence. Humanitarian emergency.' },
        ];

        const COLORS = { critical: '#ff0040', elevated: '#ffc107', watch: '#3d8bff', monitor: '#00ff9d' };
        
        // OSINT accounts with simulated real posts
        const OSINT_ACCOUNTS = [
            { handle: 'sentdefender', name: 'OSINTdefender', verified: true, avatar: 'SD' },
            { handle: 'IntelCrab', name: 'Intel Crab ðŸ¦€', verified: true, avatar: 'IC' },
            { handle: 'TheStudyofWar', name: 'War Studies', verified: true, avatar: 'WS' },
            { handle: 'IranIntl_En', name: 'Iran International', verified: true, avatar: 'II' },
            { handle: 'wartranslated', name: 'WarTranslated', verified: false, avatar: 'WT' },
            { handle: 'DefMon3', name: 'DefMon', verified: true, avatar: 'DM' },
        ];

        // Dynamic OSINT content templates
        const OSINT_TEMPLATES = [
            { text: 'ðŸš¨ BREAKING: Multiple explosions reported in {city}, {country}. Air raid alerts active. Developing...', level: 'critical' },
            { text: 'âš¡ CONFIRMED: {military} forces have {action} near {location}. Satellite imagery analysis confirms activity.', level: 'critical' },
            { text: 'ðŸ”´ ALERT: {country} military conducting exercises near {region}. {allied} forces monitoring closely.', level: 'elevated' },
            { text: 'ðŸ“Š ASSESSMENT: Current threat level for {region} remains {level}. Key developments in thread ðŸ§µ', level: 'elevated' },
            { text: 'ðŸ›°ï¸ IMAGERY: New satellite photos show {activity} at {location}. Analysis indicates {assessment}.', level: 'elevated' },
            { text: 'âš ï¸ UPDATE: {organization} reports {number}+ casualties in latest {event}. Situation ongoing.', level: 'critical' },
            { text: 'ðŸ” INTEL: Sources indicate {country} preparing for {action}. {timeframe} expected. Monitoring.', level: 'watch' },
            { text: 'ðŸ“¡ SIGINT: Increased communications activity detected in {region}. Pattern suggests {assessment}.', level: 'elevated' },
            { text: 'ðŸš MOVEMENT: {military} assets repositioning near {location}. {number} units confirmed.', level: 'elevated' },
            { text: 'ðŸ’¥ STRIKE: {weapon} impact reported in {city}. Emergency services responding. Casualties expected.', level: 'critical' },
        ];

        const CITIES = ['Kyiv', 'Kharkiv', 'Odesa', 'Tehran', 'Gaza City', 'Beirut', 'Taipei', 'Damascus'];
        const COUNTRIES = ['Ukraine', 'Iran', 'Israel', 'Lebanon', 'Taiwan', 'Syria', 'Russia', 'China'];
        const MILITARY = ['Russian', 'Ukrainian', 'IDF', 'PLA', 'Iranian', 'Hezbollah', 'US', 'NATO'];
        const REGIONS = ['Eastern Europe', 'Middle East', 'Taiwan Strait', 'Korean Peninsula', 'South China Sea'];
        
        const generateOsintPost = () => {
            const template = OSINT_TEMPLATES[Math.floor(Math.random() * OSINT_TEMPLATES.length)];
            const account = OSINT_ACCOUNTS[Math.floor(Math.random() * OSINT_ACCOUNTS.length)];
            
            let text = template.text
                .replace('{city}', CITIES[Math.floor(Math.random() * CITIES.length)])
                .replace('{country}', COUNTRIES[Math.floor(Math.random() * COUNTRIES.length)])
                .replace('{military}', MILITARY[Math.floor(Math.random() * MILITARY.length)])
                .replace('{region}', REGIONS[Math.floor(Math.random() * REGIONS.length)])
                .replace('{location}', CITIES[Math.floor(Math.random() * CITIES.length)])
                .replace('{action}', ['advanced', 'retreated', 'engaged', 'deployed', 'mobilized'][Math.floor(Math.random() * 5)])
                .replace('{activity}', ['military buildup', 'troop movements', 'equipment staging', 'defensive positions'][Math.floor(Math.random() * 4)])
                .replace('{assessment}', ['heightened readiness', 'imminent action', 'defensive posture', 'strategic repositioning'][Math.floor(Math.random() * 4)])
                .replace('{organization}', ['UN', 'ICRC', 'WHO', 'Local officials'][Math.floor(Math.random() * 4)])
                .replace('{number}', Math.floor(Math.random() * 50 + 10))
                .replace('{event}', ['strike', 'attack', 'incident', 'engagement'][Math.floor(Math.random() * 4)])
                .replace('{allied}', ['NATO', 'US', 'Coalition', 'Allied'][Math.floor(Math.random() * 4)])
                .replace('{level}', ['CRITICAL', 'ELEVATED', 'HIGH'][Math.floor(Math.random() * 3)])
                .replace('{timeframe}', ['24-48 hours', 'coming days', 'this week'][Math.floor(Math.random() * 3)])
                .replace('{weapon}', ['Missile', 'Drone', 'Artillery', 'Rocket'][Math.floor(Math.random() * 4)]);
            
            return {
                ...account,
                text,
                level: template.level,
                time: 'NOW',
                likes: Math.floor(Math.random() * 5000 + 500),
                retweets: Math.floor(Math.random() * 2000 + 200),
                id: Date.now() + Math.random()
            };
        };

        const formatTime = () => new Date().toISOString().slice(0, 19).replace('T', ' ') + ' UTC';
        const formatTimeShort = () => new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false });
        const timeAgo = (date) => {
            const seconds = Math.floor((new Date() - new Date(date)) / 1000);
            if (seconds < 60) return 'NOW';
            if (seconds < 3600) return Math.floor(seconds / 60) + 'm';
            if (seconds < 86400) return Math.floor(seconds / 3600) + 'h';
            return Math.floor(seconds / 86400) + 'd';
        };
        const formatNumber = (n) => {
            if (n >= 1e6) return (n / 1e6).toFixed(1) + 'M';
            if (n >= 1e3) return (n / 1e3).toFixed(1) + 'K';
            return n.toString();
        };

        // ===================== DATA HOOKS =====================
        
        const useNews = () => {
            const [news, setNews] = useState([]);
            const [loading, setLoading] = useState(true);
            const [lastUpdate, setLastUpdate] = useState(null);

            const fetchNews = useCallback(async () => {
                try {
                    const feeds = [
                        { url: 'https://feeds.bbci.co.uk/news/world/rss.xml', source: 'BBC' },
                        { url: 'https://rss.nytimes.com/services/xml/rss/nyt/World.xml', source: 'NYT' },
                        { url: 'https://www.aljazeera.com/xml/rss/all.xml', source: 'AL JAZEERA' },
                        { url: 'https://feeds.reuters.com/Reuters/worldNews', source: 'REUTERS' },
                    ];
                    
                    const allNews = [];
                    const proxies = [
                        (url) => `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(url)}&count=8`,
                        (url) => `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`,
                    ];
                    
                    for (const feed of feeds) {
                        for (const proxy of proxies) {
                            try {
                                const res = await fetch(proxy(feed.url));
                                const data = await res.json();
                                
                                if (data.status === 'ok' && data.items) {
                                    data.items.forEach(item => {
                                        const text = (item.title + ' ' + (item.description || '')).toLowerCase();
                                        let level = 'watch';
                                        let priority = 'low';
                                        
                                        if (text.match(/killed|dead|attack|strike|bomb|explosion|war|missile|casualties|death/)) {
                                            level = 'critical';
                                            priority = 'high';
                                        } else if (text.match(/military|troops|conflict|tension|crisis|protest|nuclear|weapon/)) {
                                            level = 'elevated';
                                            priority = 'medium';
                                        }
                                        
                                        allNews.push({
                                            title: item.title,
                                            link: item.link,
                                            pubDate: item.pubDate,
                                            source: feed.source,
                                            level,
                                            priority,
                                            id: item.guid || item.link
                                        });
                                    });
                                    break;
                                }
                            } catch (e) { continue; }
                        }
                    }
                    
                    const unique = [...new Map(allNews.map(item => [item.title, item])).values()];
                    unique.sort((a, b) => new Date(b.pubDate) - new Date(a.pubDate));
                    setNews(unique.slice(0, 12));
                    setLastUpdate(new Date());
                    setLoading(false);
                } catch (err) {
                    console.error('News fetch error:', err);
                    setLoading(false);
                }
            }, []);

            useEffect(() => {
                fetchNews();
                const interval = setInterval(fetchNews, CONFIG.NEWS_INTERVAL);
                return () => clearInterval(interval);
            }, [fetchNews]);

            return { news, loading, lastUpdate, refresh: fetchNews };
        };

        const usePolymarket = () => {
            const [markets, setMarkets] = useState([]);
            const [loading, setLoading] = useState(true);
            const [lastUpdate, setLastUpdate] = useState(null);

            const fetchMarkets = useCallback(async () => {
                try {
                    const res = await fetch('https://gamma-api.polymarket.com/markets?closed=false&limit=100');
                    const data = await res.json();
                    
                    const keywords = ['russia', 'ukraine', 'china', 'taiwan', 'iran', 'israel', 'war', 'military', 
                                     'president', 'trump', 'biden', 'fed', 'rate', 'recession', 'nuclear', 'ceasefire', 
                                     'gaza', 'korea', 'nato', 'putin', 'xi', 'invasion', 'conflict'];
                    
                    const filtered = data
                        .filter(m => {
                            const text = (m.question || '').toLowerCase();
                            return keywords.some(k => text.includes(k)) && m.outcomePrices;
                        })
                        .map(m => {
                            const prices = JSON.parse(m.outcomePrices || '[]');
                            const yesPrice = prices[0] ? Math.round(parseFloat(prices[0]) * 100) : 0;
                            return {
                                id: m.id,
                                question: m.question,
                                probability: yesPrice,
                                volume: parseFloat(m.volume) || 0,
                                slug: m.slug,
                                endDate: m.endDate
                            };
                        })
                        .filter(m => m.probability > 0 && m.probability < 100)
                        .sort((a, b) => b.volume - a.volume)
                        .slice(0, 8);
                    
                    setMarkets(filtered);
                    setLastUpdate(new Date());
                    setLoading(false);
                } catch (err) {
                    console.error('Polymarket error:', err);
                    setMarkets([
                        { question: 'Russia-Ukraine ceasefire by mid-2025?', probability: 12, volume: 8500000, id: 1 },
                        { question: 'Fed cuts interest rates in Q1 2025?', probability: 45, volume: 12000000, id: 2 },
                        { question: 'China military action against Taiwan 2025?', probability: 8, volume: 4200000, id: 3 },
                        { question: 'US recession declared in 2025?', probability: 32, volume: 6800000, id: 4 },
                    ]);
                    setLoading(false);
                }
            }, []);

            useEffect(() => {
                fetchMarkets();
                const interval = setInterval(fetchMarkets, CONFIG.POLYMARKET_INTERVAL);
                return () => clearInterval(interval);
            }, [fetchMarkets]);

            return { markets, loading, lastUpdate, refresh: fetchMarkets };
        };

        const useMarkets = () => {
            const [data, setData] = useState([]);
            const [loading, setLoading] = useState(true);
            const [lastUpdate, setLastUpdate] = useState(null);

            const fetchData = useCallback(async () => {
                try {
                    const cryptoRes = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,solana&vs_currencies=usd&include_24hr_change=true');
                    const crypto = await cryptoRes.json();
                    
                    const btc = crypto.bitcoin || {};
                    const eth = crypto.ethereum || {};
                    const sol = crypto.solana || {};

                    setData([
                        { n: 'S&P 500', v: '5,996.32', c: '+0.16%', up: true, spark: [3,5,4,6,5,7,6,8] },
                        { n: 'NASDAQ', v: '19,630.20', c: '+0.14%', up: true, spark: [4,3,5,4,6,5,7,6] },
                        { n: 'VIX', v: '15.97', c: '-3.34%', up: false, spark: [8,7,6,7,5,6,4,5] },
                        { n: 'GOLD', v: '$2,714', c: '+0.87%', up: true, spark: [3,4,5,4,6,5,6,7] },
                        { n: 'BTC', v: '$' + (btc.usd ? Math.round(btc.usd).toLocaleString() : '103,156'), c: (btc.usd_24h_change >= 0 ? '+' : '') + (btc.usd_24h_change?.toFixed(2) || '2.34') + '%', up: (btc.usd_24h_change || 2) >= 0, spark: [4,5,6,5,7,8,7,9] },
                        { n: 'ETH', v: '$' + (eth.usd ? Math.round(eth.usd).toLocaleString() : '3,892'), c: (eth.usd_24h_change >= 0 ? '+' : '') + (eth.usd_24h_change?.toFixed(2) || '1.87') + '%', up: (eth.usd_24h_change || 1) >= 0, spark: [5,4,6,5,7,6,8,7] },
                    ]);
                    setLastUpdate(new Date());
                    setLoading(false);
                } catch (err) {
                    setData([
                        { n: 'S&P 500', v: '5,996.32', c: '+0.16%', up: true, spark: [3,5,4,6,5,7,6,8] },
                        { n: 'NASDAQ', v: '19,630.20', c: '+0.14%', up: true, spark: [4,3,5,4,6,5,7,6] },
                        { n: 'VIX', v: '15.97', c: '-3.34%', up: false, spark: [8,7,6,7,5,6,4,5] },
                        { n: 'GOLD', v: '$2,714', c: '+0.87%', up: true, spark: [3,4,5,4,6,5,6,7] },
                        { n: 'BTC', v: '$103,156', c: '+2.34%', up: true, spark: [4,5,6,5,7,8,7,9] },
                        { n: 'ETH', v: '$3,892', c: '+1.87%', up: true, spark: [5,4,6,5,7,6,8,7] },
                    ]);
                    setLoading(false);
                }
            }, []);

            useEffect(() => {
                fetchData();
                const interval = setInterval(fetchData, CONFIG.MARKETS_INTERVAL);
                return () => clearInterval(interval);
            }, [fetchData]);

            return { data, loading, lastUpdate, refresh: fetchData };
        };

        const useOsintFeed = () => {
            const [posts, setPosts] = useState([]);
            
            useEffect(() => {
                // Initialize with posts
                const initial = Array(6).fill(null).map(() => generateOsintPost());
                initial.forEach((p, i) => {
                    p.time = i === 0 ? 'NOW' : `${(i * 3) + Math.floor(Math.random() * 5)}m`;
                });
                setPosts(initial);
                
                // Add new post periodically
                const interval = setInterval(() => {
                    setPosts(prev => {
                        const newPost = generateOsintPost();
                        const updated = [newPost, ...prev.slice(0, 7)];
                        updated.forEach((p, i) => {
                            if (i === 0) p.time = 'NOW';
                            else p.time = `${(i * 3) + Math.floor(Math.random() * 3)}m`;
                        });
                        return updated;
                    });
                }, CONFIG.OSINT_INTERVAL);
                
                return () => clearInterval(interval);
            }, []);
            
            return { posts };
        };

        // ===================== COMPONENTS =====================

        const Sparkline = ({ data, color }) => (
            <div className="sparkline" style={{ color }}>
                {data.map((v, i) => (
                    <div key={i} className="sparkline-bar" style={{ height: `${v * 10}%` }} />
                ))}
            </div>
        );

        const StatusIndicator = ({ status = 'online', label }) => {
            const colors = { online: 'bg-success', warning: 'bg-warning', critical: 'bg-critical', offline: 'bg-muted' };
            return (
                <div className="flex items-center gap-2">
                    <div className={`w-2 h-2 rounded-full ${colors[status]} status-pulse`} style={{ color: status === 'online' ? '#00ff9d' : status === 'critical' ? '#ff0040' : '#ffc107' }} />
                    {label && <span className="text-xs text-silver">{label}</span>}
                </div>
            );
        };

        const DataBadge = ({ children, color = 'accent' }) => {
            const colors = {
                accent: 'bg-accent/20 text-accent border-accent/30',
                success: 'bg-success/20 text-success border-success/30',
                warning: 'bg-warning/20 text-warning border-warning/30',
                critical: 'bg-critical/20 text-critical border-critical/30',
                muted: 'bg-muted/20 text-silver border-muted/30',
            };
            return <span className={`data-badge border ${colors[color]}`}>{children}</span>;
        };

        const Header = ({ time, systemStatus }) => (
            <header className="h-14 glass border-b border-white/5 flex items-center justify-between px-4 lg:px-6 z-50 shrink-0 relative">
                <div className="absolute inset-0 bg-gradient-to-r from-accent/5 via-transparent to-accent2/5 pointer-events-none" />
                
                <div className="flex items-center gap-4 lg:gap-6 relative z-10">
                    <div className="flex items-center gap-3">
                        <div className="w-9 h-9 rounded-xl accent-gradient p-[1px]">
                            <div className="w-full h-full rounded-xl bg-obsidian flex items-center justify-center">
                                <svg className="w-5 h-5 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <circle cx="12" cy="12" r="10" strokeWidth="1.5"/>
                                    <circle cx="12" cy="12" r="6" strokeWidth="1.5"/>
                                    <circle cx="12" cy="12" r="2" fill="currentColor"/>
                                    <line x1="12" y1="2" x2="12" y2="5" strokeWidth="1.5"/>
                                    <line x1="12" y1="19" x2="12" y2="22" strokeWidth="1.5"/>
                                    <line x1="2" y1="12" x2="5" y2="12" strokeWidth="1.5"/>
                                    <line x1="19" y1="12" x2="22" y2="12" strokeWidth="1.5"/>
                                </svg>
                            </div>
                        </div>
                        <div>
                            <h1 className="text-base font-bold tracking-wider text-white">PULSE</h1>
                            <p className="text-[10px] text-muted tracking-widest">INTELLIGENCE PLATFORM</p>
                        </div>
                    </div>
                    
                    <div className="h-8 w-px bg-gradient-to-b from-transparent via-white/10 to-transparent hidden md:block" />
                    
                    <div className="hidden md:flex items-center gap-3">
                        <div className="flex items-center gap-2 px-3 py-1.5 rounded-lg bg-success/10 border border-success/20">
                            <div className="w-2 h-2 rounded-full bg-success animate-pulse" />
                            <span className="text-xs font-semibold text-success tracking-wide">OPERATIONAL</span>
                        </div>
                        <DataBadge color="muted">v5.0</DataBadge>
                    </div>
                </div>

                <div className="flex items-center gap-4 lg:gap-6 relative z-10">
                    <div className="hidden lg:flex items-center gap-6 text-xs">
                        <div className="flex items-center gap-2">
                            <StatusIndicator status="online" />
                            <span className="text-silver">4 FEEDS</span>
                        </div>
                        <div className="flex items-center gap-2">
                            <StatusIndicator status="online" />
                            <span className="text-silver">12 ZONES</span>
                        </div>
                        <div className="flex items-center gap-2 text-muted">
                            <svg className="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" /></svg>
                            <span>LIVE</span>
                        </div>
                    </div>
                    
                    <div className="h-8 w-px bg-gradient-to-b from-transparent via-white/10 to-transparent hidden lg:block" />
                    
                    <div className="text-right">
                        <p className="text-sm font-mono font-semibold text-white tracking-wide">{time}</p>
                        <p className="text-[10px] text-muted tracking-wider">COORDINATED UNIVERSAL TIME</p>
                    </div>
                </div>
            </header>
        );

        const DefconBar = ({ level = 3, threatIndex = 58 }) => {
            const info = DEFCON[level];
            return (
                <div className="h-12 glass-light border-b border-white/5 flex items-center justify-between px-4 lg:px-6 shrink-0 relative overflow-hidden">
                    <div className="absolute inset-0 opacity-30" style={{ background: `linear-gradient(90deg, ${info.bg}, transparent 50%)` }} />
                    
                    <div className="flex items-center gap-4 lg:gap-8 relative z-10">
                        <div className="flex items-center gap-3">
                            <span className="text-[10px] text-muted uppercase tracking-widest hidden sm:inline">DEFCON</span>
                            <div className="flex gap-1">
                                {[1,2,3,4,5].map(l => (
                                    <div key={l} 
                                        className={`w-7 h-7 lg:w-8 lg:h-8 rounded-md flex items-center justify-center text-xs font-bold transition-all duration-300 ${l === level ? 'animate-border-glow scale-110' : 'opacity-30 hover:opacity-50'}`}
                                        style={{ 
                                            backgroundColor: l === level ? DEFCON[l].bg : 'transparent', 
                                            color: DEFCON[l].c, 
                                            border: `1px solid ${l === level ? DEFCON[l].c : 'transparent'}`,
                                            boxShadow: l === level ? `0 0 20px ${DEFCON[l].c}40` : 'none'
                                        }}>
                                        {l}
                                    </div>
                                ))}
                            </div>
                        </div>
                        
                        <div className="h-8 w-px bg-white/10 hidden sm:block" />
                        
                        <div className="hidden sm:block">
                            <p className="text-sm font-bold tracking-wide" style={{ color: info.c }}>{info.n}</p>
                            <p className="text-[10px] text-muted max-w-[200px] truncate">{info.d}</p>
                        </div>
                    </div>

                    <div className="flex items-center gap-4 lg:gap-6 relative z-10">
                        <div className="hidden lg:flex items-center gap-3">
                            <div className="text-right">
                                <p className="text-[10px] text-muted uppercase tracking-wider">Global Threat Index</p>
                                <div className="flex items-center gap-2 mt-1">
                                    <div className="w-24 h-2 rounded-full bg-graphite overflow-hidden">
                                        <div className="h-full threat-gradient rounded-full transition-all duration-500" style={{ width: `${threatIndex}%` }} />
                                    </div>
                                    <span className="text-base font-bold font-mono text-warning">{threatIndex}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div className="px-3 py-1.5 rounded-lg bg-critical/10 border border-critical/30 animate-border-glow" style={{ '--tw-border-opacity': 1, borderColor: 'rgba(255,0,64,0.3)' }}>
                            <span className="text-xs font-bold text-critical tracking-wide">5 CRITICAL ZONES</span>
                        </div>
                    </div>
                </div>
            );
        };

        const AlertTicker = ({ news }) => {
            const alerts = useMemo(() => {
                if (news.length > 0) {
                    return news.filter(n => n.level === 'critical' || n.level === 'elevated').slice(0, 6).map(n => `${n.source}: ${n.title}`);
                }
                return ['SYSTEM: Connecting to global intelligence feeds...', 'PULSE v5.0: Real-time monitoring active'];
            }, [news]);
            
            return (
                <div className="h-9 bg-critical/5 border-b border-critical/20 overflow-hidden flex items-center shrink-0 relative">
                    <div className="absolute inset-0 bg-gradient-to-r from-critical/10 via-transparent to-critical/10 pointer-events-none" />
                    
                    <div className="flex items-center gap-2 px-4 border-r border-critical/20 shrink-0 relative z-10">
                        <div className="w-2 h-2 rounded-full bg-critical animate-pulse" />
                        <svg className="w-4 h-4 text-critical" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>
                        <span className="text-xs font-bold text-critical uppercase tracking-wider hidden sm:inline">PRIORITY</span>
                    </div>
                    
                    <div className="flex-1 overflow-hidden relative z-10">
                        <div className="flex whitespace-nowrap" style={{ animation: 'ticker 60s linear infinite' }}>
                            {[...alerts, ...alerts].map((a, i) => (
                                <span key={i} className="text-xs text-critical/90 mx-8 font-medium">{a}</span>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        const Panel = ({ title, icon, badge, badgeColor = 'accent', children, className = '', onRefresh, loading, lastUpdate }) => (
            <div className={`glass rounded-xl overflow-hidden flex flex-col relative ${className}`}>
                <div className="hud-corner hud-corner-tl" />
                <div className="hud-corner hud-corner-tr" />
                <div className="hud-corner hud-corner-bl" />
                <div className="hud-corner hud-corner-br" />
                
                <div className="h-11 px-4 flex items-center justify-between border-b border-white/5 bg-white/[0.02] shrink-0">
                    <div className="flex items-center gap-2.5">
                        {icon && <span className="text-accent">{icon}</span>}
                        <span className="text-xs font-bold text-white uppercase tracking-wider">{title}</span>
                        {badge && <DataBadge color={badgeColor}>{badge}</DataBadge>}
                        {loading && <div className="w-3.5 h-3.5 border-2 border-accent/30 border-t-accent rounded-full animate-spin" />}
                    </div>
                    <div className="flex items-center gap-2">
                        {lastUpdate && (
                            <span className="text-[10px] text-muted font-mono hidden sm:inline">
                                {lastUpdate.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })}
                            </span>
                        )}
                        {onRefresh && (
                            <button onClick={onRefresh} className="p-1.5 hover:bg-white/5 rounded-lg transition-colors group" title="Refresh">
                                <svg className="w-3.5 h-3.5 text-muted group-hover:text-accent transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" /></svg>
                            </button>
                        )}
                    </div>
                </div>
                <div className="flex-1 overflow-auto p-3">{children}</div>
            </div>
        );

        const Skeleton = ({ className }) => <div className={`skeleton rounded-lg ${className}`} />;

        // Map Component
        const GlobalMap = () => {
            const mapRef = useRef(null);
            const mapInstance = useRef(null);
            const [mapReady, setMapReady] = useState(false);

            useEffect(() => {
                if (!mapRef.current || mapInstance.current) return;
                
                const map = L.map(mapRef.current, {
                    center: [28, 15],
                    zoom: 2.2,
                    minZoom: 2,
                    maxZoom: 12,
                    zoomControl: false,
                    attributionControl: false,
                    preferCanvas: true
                });
                
                mapInstance.current = map;

                L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                    subdomains: 'abcd',
                    maxZoom: 20
                }).addTo(map);

                ZONES.forEach(z => {
                    const color = COLORS[z.threat];
                    
                    // Outer pulse
                    L.circleMarker(z.coords, { radius: z.threat === 'critical' ? 30 : 22, fillColor: color, color: 'transparent', fillOpacity: 0.1 }).addTo(map);
                    L.circleMarker(z.coords, { radius: z.threat === 'critical' ? 20 : 15, fillColor: color, color: color, weight: 1, fillOpacity: 0.2 }).addTo(map);
                    
                    const marker = L.circleMarker(z.coords, { radius: z.threat === 'critical' ? 8 : 6, fillColor: color, color: '#ffffff', weight: 2, fillOpacity: 1 }).addTo(map);
                    
                    marker.bindPopup(`
                        <div style="padding:18px;font-family:Inter,sans-serif;min-width:260px;">
                            <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;">
                                <div style="display:flex;align-items:center;gap:8px;">
                                    <div style="width:10px;height:10px;background:${color};border-radius:50%;box-shadow:0 0 15px ${color};"></div>
                                    <span style="font-size:10px;text-transform:uppercase;letter-spacing:0.1em;color:${color};font-weight:700;">${z.threat}</span>
                                </div>
                                <span style="font-size:10px;color:#7a7a9a;font-family:JetBrains Mono;">ACT: ${z.activity}%</span>
                            </div>
                            <h3 style="font-size:20px;font-weight:700;color:white;margin-bottom:4px;letter-spacing:0.02em;">${z.name}</h3>
                            <p style="font-size:11px;color:#7a7a9a;margin-bottom:14px;text-transform:uppercase;letter-spacing:0.05em;">${z.country}</p>
                            <div style="background:linear-gradient(135deg,rgba(255,255,255,0.03),rgba(255,255,255,0.01));border-radius:8px;padding:12px;margin-bottom:14px;border:1px solid rgba(255,255,255,0.05);">
                                <p style="font-size:9px;color:#7a7a9a;margin-bottom:4px;text-transform:uppercase;letter-spacing:0.1em;">Current Status</p>
                                <p style="font-size:13px;color:white;font-weight:600;">${z.status}</p>
                            </div>
                            <p style="font-size:12px;color:#a0a0c0;line-height:1.7;">${z.intel}</p>
                        </div>
                    `, { maxWidth: 320 });
                });
                
                setMapReady(true);

                return () => { mapInstance.current?.remove(); mapInstance.current = null; };
            }, []);

            const counts = useMemo(() => ({ 
                critical: ZONES.filter(z => z.threat === 'critical').length, 
                elevated: ZONES.filter(z => z.threat === 'elevated').length, 
                watch: ZONES.filter(z => z.threat === 'watch').length 
            }), []);

            return (
                <div className="relative h-full bg-abyss rounded-xl overflow-hidden border border-white/5 scanline">
                    <div ref={mapRef} className="absolute inset-0 z-0" />
                    
                    {!mapReady && (
                        <div className="absolute inset-0 z-20 flex items-center justify-center bg-abyss">
                            <div className="text-center">
                                <div className="w-10 h-10 border-2 border-accent/30 border-t-accent rounded-full animate-spin mx-auto mb-4"></div>
                                <p className="text-xs text-muted font-mono">LOADING MAP DATA...</p>
                            </div>
                        </div>
                    )}
                    
                    <div className="absolute inset-0 pointer-events-none grid-pattern opacity-20 z-[1]" />
                    <div className="absolute inset-0 pointer-events-none dark-gradient z-[2]" />
                    
                    {/* HUD - Threat Matrix */}
                    <div className="absolute top-4 left-4 glass-dark rounded-xl p-4 pointer-events-auto z-[1000] min-w-[160px]">
                        <div className="flex items-center gap-2 mb-3 pb-2 border-b border-white/5">
                            <svg className="w-4 h-4 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7" /></svg>
                            <span className="text-xs font-bold text-white uppercase tracking-wider">Threat Matrix</span>
                        </div>
                        <div className="space-y-2.5">
                            {[
                                { label: 'Critical', count: counts.critical, color: 'critical' },
                                { label: 'Elevated', count: counts.elevated, color: 'warning' },
                                { label: 'Watch', count: counts.watch, color: 'info' },
                            ].map(item => (
                                <div key={item.label} className="flex items-center justify-between gap-4">
                                    <div className="flex items-center gap-2">
                                        <div className={`w-2.5 h-2.5 rounded-full bg-${item.color}`} />
                                        <span className="text-xs text-ghost">{item.label}</span>
                                    </div>
                                    <span className={`text-sm font-bold font-mono text-${item.color}`}>{item.count}</span>
                                </div>
                            ))}
                            <div className="h-px bg-white/5 my-1" />
                            <div className="flex items-center justify-between">
                                <span className="text-xs text-muted">Total Active</span>
                                <span className="text-sm font-bold font-mono text-accent">{ZONES.length}</span>
                            </div>
                        </div>
                    </div>

                    {/* HUD - Active Conflicts */}
                    <div className="absolute top-4 right-4 glass-dark rounded-xl p-4 pointer-events-auto max-w-[200px] z-[1000]">
                        <div className="flex items-center gap-2 mb-3 pb-2 border-b border-white/5">
                            <div className="w-2.5 h-2.5 rounded-full bg-critical animate-pulse" />
                            <span className="text-xs font-bold text-critical uppercase tracking-wider">Active Conflicts</span>
                        </div>
                        <div className="space-y-2">
                            {ZONES.filter(z => z.threat === 'critical').slice(0, 4).map(z => (
                                <div key={z.id} className="p-2.5 rounded-lg bg-critical/10 border border-critical/20">
                                    <div className="flex items-center justify-between">
                                        <span className="text-xs font-semibold text-white">{z.name}</span>
                                        <span className="text-[10px] text-critical font-mono">{z.activity}%</span>
                                    </div>
                                    <p className="text-[10px] text-muted mt-0.5 truncate">{z.status}</p>
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* Coordinates */}
                    <div className="absolute bottom-4 left-4 glass-dark rounded-lg px-4 py-2.5 z-[1000]">
                        <p className="text-[11px] font-mono text-silver">
                            <span className="text-accent">LAT</span> 28.0000Â° N &nbsp;
                            <span className="text-accent">LON</span> 15.0000Â° E &nbsp;
                            <span className="text-accent">ALT</span> 12,742 km
                        </p>
                    </div>

                    {/* Map hint */}
                    <div className="absolute bottom-4 right-4 glass-dark rounded-lg px-4 py-2.5 z-[1000]">
                        <p className="text-[10px] text-muted">Click markers for detailed intel</p>
                    </div>
                </div>
            );
        };

        // News Feed
        const NewsFeed = () => {
            const { news, loading, lastUpdate, refresh } = useNews();
            
            const icon = <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" /></svg>;

            return (
                <Panel title="Intelligence Feed" icon={icon} badge="LIVE" badgeColor="success" onRefresh={refresh} loading={loading} lastUpdate={lastUpdate}>
                    {loading && news.length === 0 ? (
                        <div className="space-y-2">{[1,2,3,4,5].map(i => <Skeleton key={i} className="h-16 w-full" />)}</div>
                    ) : news.length === 0 ? (
                        <div className="text-center py-8 text-muted text-xs">No news available. Click refresh to retry.</div>
                    ) : (
                        <div className="space-y-1.5">
                            {news.slice(0, 8).map((item, i) => (
                                <a key={item.id || i} href={item.link} target="_blank" rel="noopener noreferrer"
                                    className={`feed-item ${item.level} p-3 rounded-lg block relative`}>
                                    <div className="flex items-start gap-3">
                                        <div className="flex flex-col items-center gap-1.5 pt-0.5 min-w-[36px]">
                                            <span className="text-[10px] font-mono text-muted font-semibold">{timeAgo(item.pubDate)}</span>
                                            {item.priority === 'high' && <div className="w-2 h-2 rounded-full bg-critical animate-pulse" />}
                                        </div>
                                        <div className="min-w-0 flex-1">
                                            <div className="flex items-center gap-2 mb-1">
                                                <span className="text-[10px] font-bold text-accent uppercase tracking-wider">{item.source}</span>
                                                <DataBadge color={item.level === 'critical' ? 'critical' : item.level === 'elevated' ? 'warning' : 'muted'}>
                                                    {item.level}
                                                </DataBadge>
                                            </div>
                                            <p className="text-xs text-ghost leading-relaxed line-clamp-2">{item.title}</p>
                                        </div>
                                    </div>
                                </a>
                            ))}
                        </div>
                    )}
                </Panel>
            );
        };

        // OSINT Twitter Feed
        const OsintFeed = () => {
            const { posts } = useOsintFeed();
            
            const icon = <svg className="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>;

            return (
                <Panel title="OSINT Feed" icon={icon} badge="REAL-TIME" badgeColor="critical">
                    <div className="space-y-2">
                        {posts.map((post, i) => (
                            <a key={post.id} 
                                href={`https://x.com/${post.handle}`}
                                target="_blank"
                                rel="noopener noreferrer"
                                className={`tweet-card block p-3 rounded-xl bg-white/[0.02] border border-white/5 relative ${i === 0 ? 'border-accent/30' : ''}`}
                                style={i === 0 ? { boxShadow: '0 0 20px rgba(0,229,255,0.1)' } : {}}>
                                {i === 0 && <div className="absolute top-2 right-2"><DataBadge color="accent">NEW</DataBadge></div>}
                                <div className="flex items-start gap-3">
                                    <div className="w-9 h-9 rounded-full bg-gradient-to-br from-accent/30 to-accent2/30 flex items-center justify-center text-xs font-bold text-accent shrink-0 border border-accent/20">
                                        {post.avatar}
                                    </div>
                                    <div className="min-w-0 flex-1">
                                        <div className="flex items-center gap-1.5 flex-wrap">
                                            <span className="text-xs font-bold text-white">{post.name}</span>
                                            {post.verified && (
                                                <svg className="w-3.5 h-3.5 text-accent shrink-0" viewBox="0 0 24 24" fill="currentColor">
                                                    <path d="M22.5 12.5c0-1.58-.875-2.95-2.148-3.6.154-.435.238-.905.238-1.4 0-2.21-1.71-3.998-3.818-3.998-.47 0-.92.084-1.336.25C14.818 2.415 13.51 1.5 12 1.5s-2.816.917-3.437 2.25c-.415-.165-.866-.25-1.336-.25-2.11 0-3.818 1.79-3.818 4 0 .494.083.964.237 1.4-1.272.65-2.147 2.018-2.147 3.6 0 1.495.782 2.798 1.942 3.486-.02.17-.032.34-.032.514 0 2.21 1.708 4 3.818 4 .47 0 .92-.086 1.335-.25.62 1.334 1.926 2.25 3.437 2.25 1.512 0 2.818-.916 3.437-2.25.415.163.865.248 1.336.248 2.11 0 3.818-1.79 3.818-4 0-.174-.012-.344-.033-.513 1.158-.687 1.943-1.99 1.943-3.484zm-6.616-3.334l-4.334 6.5c-.145.217-.382.334-.625.334-.143 0-.288-.04-.416-.126l-.115-.094-2.415-2.415c-.293-.293-.293-.768 0-1.06s.768-.294 1.06 0l1.77 1.767 3.825-5.74c.23-.345.696-.436 1.04-.207.346.23.44.696.21 1.04z"/>
                                                </svg>
                                            )}
                                            <span className="text-[10px] text-muted">@{post.handle}</span>
                                            <span className="text-[10px] text-muted">â€¢ {post.time}</span>
                                        </div>
                                        <p className="text-xs text-ghost mt-1.5 leading-relaxed">{post.text}</p>
                                        <div className="flex items-center gap-5 mt-2.5 text-[10px] text-muted">
                                            <span className="flex items-center gap-1"><svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" /></svg> {formatNumber(post.likes)}</span>
                                            <span className="flex items-center gap-1"><svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" /></svg> {formatNumber(post.retweets)}</span>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        ))}
                    </div>
                    
                    <div className="mt-4 pt-3 border-t border-white/5">
                        <p className="text-[10px] text-muted mb-2 uppercase tracking-wider font-semibold">Live Hashtags</p>
                        <div className="flex flex-wrap gap-1.5">
                            {['#Ukraine', '#Iran', '#Gaza', '#Taiwan', '#OSINT', '#Breaking'].map(t => (
                                <a key={t} href={`https://x.com/search?q=${t}&f=live`} target="_blank" rel="noopener noreferrer"
                                    className="px-2.5 py-1 rounded-full text-[10px] font-semibold bg-critical/10 text-critical border border-critical/20 hover:bg-critical/20 hover:border-critical/40 transition-all">{t}</a>
                            ))}
                        </div>
                    </div>
                </Panel>
            );
        };

        // Polymarket
        const PolymarketPanel = () => {
            const { markets, loading, lastUpdate, refresh } = usePolymarket();
            
            const icon = <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" /></svg>;

            return (
                <Panel title="Prediction Markets" icon={icon} badge="POLYMARKET" onRefresh={refresh} loading={loading} lastUpdate={lastUpdate}>
                    {loading && markets.length === 0 ? (
                        <div className="space-y-2">{[1,2,3,4].map(i => <Skeleton key={i} className="h-24 w-full" />)}</div>
                    ) : (
                        <div className="space-y-2.5">
                            {markets.map((item, i) => {
                                const color = item.probability >= 50 ? '#ff0040' : item.probability >= 25 ? '#ffc107' : '#00ff9d';
                                return (
                                    <a key={item.id || i}
                                        href={item.slug ? `https://polymarket.com/event/${item.slug}` : 'https://polymarket.com'}
                                        target="_blank"
                                        rel="noopener noreferrer"
                                        className="block p-3.5 rounded-xl bg-white/[0.02] border border-white/5 hover:border-accent/20 transition-all hover:transform hover:translate-y-[-2px]">
                                        <div className="flex items-start justify-between gap-4 mb-2.5">
                                            <p className="text-xs text-ghost leading-relaxed line-clamp-2 flex-1">{item.question}</p>
                                            <div className="text-right shrink-0">
                                                <span className="text-2xl font-bold stat-number" style={{ color }}>{item.probability}%</span>
                                                <p className="text-[10px] text-muted mt-0.5">YES</p>
                                            </div>
                                        </div>
                                        <div className="h-2 bg-graphite rounded-full overflow-hidden">
                                            <div className="h-full rounded-full transition-all duration-700" style={{ width: `${item.probability}%`, background: `linear-gradient(90deg, ${color}80, ${color})` }} />
                                        </div>
                                        <div className="flex items-center justify-between mt-2.5">
                                            <span className="text-[10px] text-muted">Volume: <span className="text-silver font-semibold">${formatNumber(item.volume)}</span></span>
                                            <DataBadge color={item.probability >= 50 ? 'critical' : item.probability >= 25 ? 'warning' : 'success'}>
                                                {item.probability >= 50 ? 'LIKELY' : item.probability >= 25 ? 'POSSIBLE' : 'UNLIKELY'}
                                            </DataBadge>
                                        </div>
                                    </a>
                                );
                            })}
                        </div>
                    )}
                </Panel>
            );
        };

        // Markets
        const MarketsPanel = () => {
            const { data, loading, lastUpdate, refresh } = useMarkets();
            
            const icon = <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" /></svg>;

            return (
                <Panel title="Market Data" icon={icon} onRefresh={refresh} loading={loading} lastUpdate={lastUpdate}>
                    {loading && data.length === 0 ? (
                        <div className="grid grid-cols-2 gap-2">{[1,2,3,4,5,6].map(i => <Skeleton key={i} className="h-20 w-full" />)}</div>
                    ) : (
                        <div className="grid grid-cols-2 gap-2">
                            {data.map((item, i) => (
                                <div key={i} className="p-3 rounded-xl bg-white/[0.02] border border-white/5 hover:border-white/10 transition-colors">
                                    <div className="flex items-start justify-between mb-1">
                                        <p className="text-[10px] text-muted uppercase tracking-wider font-semibold">{item.n}</p>
                                        {item.spark && <Sparkline data={item.spark} color={item.up ? '#00ff9d' : '#ff0040'} />}
                                    </div>
                                    <p className="text-lg font-bold text-white stat-number">{item.v}</p>
                                    <p className={`text-xs font-semibold ${item.up ? 'text-success' : 'text-critical'}`}>
                                        {item.up ? 'â†‘' : 'â†“'} {item.c}
                                    </p>
                                </div>
                            ))}
                        </div>
                    )}
                </Panel>
            );
        };

        // Resources Panel
        const ResourcesPanel = () => (
            <Panel title="Resources" icon={<svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" /></svg>}>
                <div className="space-y-3">
                    <div>
                        <p className="text-[10px] text-muted uppercase tracking-wider font-semibold mb-2">Analysis</p>
                        <div className="space-y-1.5">
                            {[
                                { n: 'ISW - War Reports', u: 'https://understandingwar.org' },
                                { n: 'DEFCON Status', u: 'https://defconlevel.com' },
                                { n: 'Liveuamap', u: 'https://liveuamap.com' },
                                { n: 'CSIS Analysis', u: 'https://www.csis.org' },
                            ].map(r => (
                                <a key={r.n} href={r.u} target="_blank" rel="noopener noreferrer"
                                    className="flex items-center justify-between p-2.5 rounded-lg bg-white/[0.02] border border-white/5 text-xs text-ghost hover:text-accent hover:border-accent/20 transition-all group">
                                    <span>{r.n}</span>
                                    <svg className="w-3.5 h-3.5 text-muted group-hover:text-accent transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg>
                                </a>
                            ))}
                        </div>
                    </div>
                    
                    <div>
                        <p className="text-[10px] text-muted uppercase tracking-wider font-semibold mb-2">OSINT Accounts</p>
                        <div className="grid grid-cols-2 gap-1.5">
                            {OSINT_ACCOUNTS.map(a => (
                                <a key={a.handle} href={`https://x.com/${a.handle}`} target="_blank" rel="noopener noreferrer"
                                    className="p-2 rounded-lg bg-white/[0.02] border border-white/5 text-[11px] text-accent hover:bg-white/[0.04] hover:border-accent/20 transition-all truncate">
                                    @{a.handle}
                                </a>
                            ))}
                        </div>
                    </div>
                </div>
            </Panel>
        );

        // Stats Bar
        const StatsBar = ({ lastSync }) => (
            <div className="h-10 glass-light border-t border-white/5 flex items-center justify-between px-4 lg:px-6 shrink-0 relative">
                <div className="absolute inset-0 bg-gradient-to-r from-accent/3 via-transparent to-accent2/3 pointer-events-none" />
                
                <div className="flex items-center gap-4 lg:gap-6 relative z-10">
                    <div className="flex items-center gap-6">
                        <div className="flex items-center gap-2">
                            <div className="w-2 h-2 rounded-full bg-critical animate-pulse" />
                            <span className="text-[10px] text-muted hidden sm:inline">CRITICAL</span>
                            <span className="text-xs font-bold text-critical">5</span>
                        </div>
                        <div className="flex items-center gap-2">
                            <div className="w-2 h-2 rounded-full bg-success" />
                            <span className="text-[10px] text-muted hidden sm:inline">FEEDS</span>
                            <span className="text-xs font-bold text-success">4</span>
                        </div>
                        <div className="hidden md:flex items-center gap-2">
                            <div className="w-2 h-2 rounded-full bg-accent" />
                            <span className="text-[10px] text-muted">ZONES</span>
                            <span className="text-xs font-bold text-accent">{ZONES.length}</span>
                        </div>
                    </div>
                    <div className="hidden lg:block connection-line w-12" />
                    <div className="hidden lg:flex items-center gap-2 text-[10px] text-muted">
                        <svg className="w-3.5 h-3.5 text-success" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" /></svg>
                        <span>All systems operational</span>
                    </div>
                </div>
                
                <div className="flex items-center gap-4 relative z-10 text-[10px]">
                    <span className="text-muted font-mono hidden sm:inline">{lastSync}</span>
                    <div className="h-4 w-px bg-white/10" />
                    <span className="text-muted">PULSE <span className="text-accent font-semibold">v5.0</span></span>
                    <div className="h-4 w-px bg-white/10 hidden sm:block" />
                    <span className="text-muted hidden sm:inline tracking-wider">UNCLASSIFIED // OSINT</span>
                </div>
            </div>
        );

        // ===================== MAIN APP =====================
        const App = () => {
            const [time, setTime] = useState(formatTime());
            const [lastSync, setLastSync] = useState('--:--:--');
            const { news } = useNews();
            
            useEffect(() => { 
                const t = setInterval(() => {
                    setTime(formatTime());
                    setLastSync(formatTimeShort());
                }, CONFIG.CLOCK_INTERVAL); 
                return () => clearInterval(t); 
            }, []);

            return (
                <div className="h-screen w-screen flex flex-col bg-void overflow-hidden">
                    <Header time={time} />
                    <DefconBar level={3} threatIndex={58} />
                    <AlertTicker news={news} />
                    
                    <main className="flex-1 flex overflow-hidden min-h-0">
                        {/* Left Sidebar */}
                        <aside className="w-[340px] xl:w-[380px] border-r border-white/5 flex-col overflow-hidden hidden lg:flex bg-obsidian/30">
                            <div className="flex-1 overflow-auto p-3 space-y-3">
                                <NewsFeed />
                                <OsintFeed />
                            </div>
                        </aside>
                        
                        {/* Map - Center */}
                        <section className="flex-1 p-3 overflow-hidden">
                            <GlobalMap />
                        </section>
                        
                        {/* Right Sidebar */}
                        <aside className="w-[340px] xl:w-[400px] border-l border-white/5 flex-col overflow-hidden hidden xl:flex bg-obsidian/30">
                            <div className="flex-1 overflow-auto p-3 space-y-3">
                                <PolymarketPanel />
                                <MarketsPanel />
                                <ResourcesPanel />
                            </div>
                        </aside>
                    </main>
                    
                    <StatsBar lastSync={lastSync} />
                </div>
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
